**Query:**

Store wise Revenue:

- Break down the revenue generated by each store. This helps in understanding the contribution of individual stores to the overall revenue.

**Query cost:** 9888

**Solution:**

```sql
select
    f.FACILITY_ID,
    f.FACILITY_NAME,
    round(sum(oisga.QUANTITY*oi.UNIT_PRICE), 2) REVENUE
    -- sum(oisga.QUANTITY*oi.UNIT_PRICE)
from
    order_item_ship_group oisg
join order_item_ship_group_assoc oisga
    on oisga.ORDER_ID = oisg.ORDER_ID
    and oisga.SHIP_GROUP_SEQ_ID = oisg.SHIP_GROUP_SEQ_ID
join order_item oi
    on oisga.ORDER_ID = oi.ORDER_ID
    and oisga.ORDER_ITEM_SEQ_ID = oi.ORDER_ITEM_SEQ_ID
    and oi.STATUS_ID = "ITEM_COMPLETED"
join facility f
    on f.FACILITY_ID = oisg.FACILITY_ID
join facility_type ft
    on ft.FACILITY_TYPE_ID = f.FACILITY_TYPE_ID
    and ft.PARENT_TYPE_ID = "PHYSICAL_STORE"
group by f.FACILITY_ID
;
```

![alt text](image.png)

| FACILITY_ID | FACILITY_NAME                             | REVENUE   |
| ----------- | ----------------------------------------- | --------- |
| 1           | 1 - Store 1                               | 137467.90 |
| 10          | 10 - Store 10                             | 2974.98   |
| 100         | 100 - Store 100                           | 18278.94  |
| 102         | 102 - Store 102                           | 719.85    |
| 103         | 103 - Store 103                           | 354.40    |
| 104         | 104 - Store 104                           | 319.80    |
| 109         | 109 - Store 109                           | 5750.01   |
| 111         | 111 - Store 111                           | 9197.68   |
| 113         | 113- Store 113                            | 46561.22  |
| 114         | 114 - Store 114                           | 422.83    |
| 119         | 119 - Store 119                           | 140.91    |
| 120         | 120 - Store 120                           | 77.98     |
| 121         | 121 - Store 121                           | 132.44    |
| 123         | 123 - Store 123                           | 1068.86   |
| 124         | 124 - Store 124                           | 23.94     |
| 126         | 126 - Store 126                           | 1887.62   |
| 127         | 127 - Store 127                           | 709.78    |
| 128         | 128 - Store 128                           | 310.85    |
| 129         | 129 - Store 129                           | 79.98     |
| 131         | 131 - Store 131                           | 996.62    |
| 133         | 133 - Store 133                           | 60.00     |
| 134         | 134 - Store 134                           | 264.84    |
| 135         | 135 - Store 135                           | 73.99     |
| 137         | 137 - Store 137                           | 194.95    |
| 14          | 14 - Smith Haven Mall                     | 5003.30   |
| 140         | 140 - Store 140                           | 1765.23   |
| 141         | 141 - Store 141                           | 271.80    |
| 144         | 144 - Store 144                           | 99.00     |
| 145         | 145 - Store 145                           | 428.94    |
| 146         | 146 - Store 146                           | 119.00    |
| 147         | 147 - Store 147                           | 253.96    |
| 15          | 15 - Store 15                             | 2479.87   |
| 17          | 17 - Store 17                             | 301.83    |
| 19          | 19 - Brea Mall                            | 194.95    |
| 2           | 2 - Store 2                               | 40491.85  |
| 22          | 22 - Store 22                             | 277.86    |
| 25          | 25 - Store 25                             | 667.79    |
| 254         | Store 254                                 | 35491.11  |
| 28          | 28 - Store 28                             | 155.96    |
| 3           | 3 - Store 3                               | 19684.29  |
| 38          | 38 - Store 38                             | 159.92    |
| 4           | 4 - Store 4                               | 7502.50   |
| 42          | 42 - Store 42                             | 128.99    |
| 44          | 44 - The Westchester - STEVEN             | 837.79    |
| 45          | 45 - Store 45                             | 3383.47   |
| 48          | 48 - (048) Super Team                     | 77.98     |
| 5           | 5 - Store 5                               | 13388.48  |
| 50          | 50 - Store 50                             | 2344.69   |
| 511         | 511 - Philadelphia Premium Outlets        | 549.65    |
| 520         | 520 - Las Americas Premium Outlets        | 11.97     |
| 522         | 522 Foxwoods Tanger Outlets               | 100.00    |
| 527         | 527 - National Harbor Tanger Outlets      | 559.65    |
| 530         | 530 - Riverwalk Outlets                   | 373.79    |
| 533         | 533 - The Mills at Jersey Gardens Outlets | 80.99     |
| 544         | 544 - Katy Mills Outlets                  | 87.45     |
| 561         | 561 - Collins Avenue                      | 20.99     |
| 566         | 566 Livingston                            | 79.95     |
| 568         | 568 Orlando International Premium         | 11.97     |
| 57          | 57 - Store 57                             | 327.58    |
| 605         | Store 605 - Superga (Soho)                | 16408.02  |
| 7           | 7 - Store 7                               | 3746.45   |
| 70          | 70 - Store 70                             | 268.84    |
| 71          | 71 - Store 71                             | 137.95    |
| 711         | 711 - 711 Lincoln Road - STEVEN           | 14915.62  |
| 72          | 72 - Store 72                             | 58.98     |
| 73          | 73 - Newbury Street                       | 260.82    |
| 74          | 74 - Store 74                             | 555.73    |
| 75          | 75 - Store 75                             | 155.96    |
| 77          | 77 - Store 77                             | 694.80    |
| 78          | 78 - Store 78                             | 16835.12  |
| 79          | 79 - Store 79                             | 262.88    |
| 81          | 81 - Store 81                             | 214.80    |
| 82          | 82 - Store 82                             | 176.96    |
| 83          | 83 - Store 83                             | 157.92    |
| 85          | 85 - Store 85                             | 1135.42   |
| 9           | 9 - Store 9                               | 9465.90   |
| 96          | 96 - Store 96                             | 117.99    |
| 990         | 990 - Steve Madden 990                    | 14007.97  |
| 991         | 991 - Florida Warehouse                   | 1567.00   |
